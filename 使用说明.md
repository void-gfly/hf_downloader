# Hugging Face 模型批量下载工具 v1.0 - 使用说明

## 🎯 功能概述

这个工具可以帮助您批量下载 Hugging Face 上的模型仓库，支持：
- 一键下载整个仓库的所有文件
- 保持原始目录结构
- 支持文件类型过滤（包含和排除模式）
- 断点续传功能
- 详细进度显示和统计
- 设置自动保存和加载
- 友好的图形界面

## 📦 安装步骤

### 方法一：自动安装（推荐）
1. 双击运行 `install.bat`
2. 等待依赖包安装完成

### 方法二：手动安装
```bash
pip install huggingface_hub gooey requests
```

## 🚀 使用方法

### GUI界面版本
1. 双击运行 `run.bat` 或执行：
   ```bash
   python hf_downloader.py
   ```

2. 在弹出的界面中填写：
   - **Hugging Face URL**: 要下载的仓库链接
   - **下载目录**: 文件保存位置
   - **访问令牌**: 如果是私有仓库或需要认证的仓库，请输入您的Hugging Face token
   - **包含模式**: 要下载的文件模式，用逗号分隔 (例如: *.json,*.md)
   - **排除模式**: 要排除的文件模式，用逗号分隔 (例如: *.safetensors,*.bin)
   - **并发数**: 同时下载的文件数（默认3个）
   - **进度文件**: 进度保存文件路径

3. 点击"开始"按钮开始下载

💾 **智能设置记忆**: 程序会自动保存您的设置，下次启动时会加载上次使用的配置。

## 📝 支持的URL格式

- `https://huggingface.co/username/repo_name`
- `https://huggingface.co/username/repo_name/tree/main`
- `https://huggingface.co/username/repo_name/tree/branch_name`
- `https://huggingface.co/repo_name` (单名称仓库，如 gpt2)

## 🔑 获取访问令牌 (Token)

对于私有仓库或需要同意使用条款的模型，您需要Hugging Face访问令牌：

### 获取步骤：
1. 访问 [Hugging Face](https://huggingface.co/) 并登录您的账户
2. 点击右上角头像 → **Settings**
3. 在左侧菜单中选择 **Access Tokens**
4. 点击 **New token** 创建新令牌
5. 选择权限类型：
   - **Read**: 用于下载模型（推荐）
   - **Write**: 用于上传模型
6. 复制生成的令牌（格式：`hf_xxxxxxxxxxxx`）

### 使用令牌：
在"访问令牌"字段中粘贴您的token

⚠️ **安全提示**: 请妥善保管您的token，不要分享给他人或提交到代码仓库中。

## ⚙️ 高级设置

### 文件过滤
- **包含模式**: 只下载特定类型的文件
  - 示例：`*.safetensors,*.json` (只下载模型和配置文件)
  - 示例：`*.bin,*.ckpt` (只下载二进制模型文件)
  - 留空表示下载所有文件

- **排除模式**: 跳过不需要的文件
  - 示例：`*.md,*.txt` (忽略文档文件)
  - 示例：`*.git*` (忽略git相关文件)
  - 留空表示不排除任何文件

### 下载设置
- **并发数**: 控制同时下载的文件数量，建议设置为1-5之间
- **进度文件**: 保存下载进度的文件，支持断点续传

## 📁 输出结构

下载的文件会按以下结构保存：
```
downloads/
└── username_repo_name/
    ├── model.safetensors
    ├── config.json
    ├── tokenizer.json
    └── subfolder/
        └── additional_files...
```

## 🔄 断点续传功能

程序支持智能断点续传：
- 下载中断后，重新运行程序会自动继续下载
- 已下载的文件会被跳过
- 支持文件完整性检查
- 进度信息自动保存到进度文件中

## 📊 进度显示

程序提供详细的进度信息：
- 实时显示当前下载的文件
- 显示已完成/总文件数和百分比
- 显示下载速度（文件/秒）
- 显示已下载的总大小
- 预计剩余时间
- 每10个文件显示详细统计

## 🔧 常见问题解决

### 1. 程序无法启动
- 确保已安装 Python 3.7+
- 运行 `install.bat` 安装依赖
- 检查是否有杀毒软件阻止

### 2. 下载速度慢
- 检查网络连接
- 考虑使用VPN
- 程序支持断点续传，可以中断后重新开始
- 适当调整并发数

### 3. 权限错误
- 确保仓库是公开的
- 对于私有仓库或需要认证的仓库，请提供有效的访问令牌
- 某些模型需要先同意使用条款才能下载

### 4. 磁盘空间不足
- 检查可用空间
- 使用排除模式跳过不需要的文件

### 5. 内存不足
- 关闭其他程序
- 降低并发数

## 📊 日志文件

程序会生成 `advanced_download.log` 日志文件，包含：
- 下载进度
- 错误信息
- 文件列表
- 统计数据

## 💡 使用技巧

1. **批量下载多个仓库**: 可以多次运行程序，每次下载一个仓库
2. **只下载模型文件**: 设置包含模式为 `*.safetensors,*.bin,*.ckpt`
3. **节省空间**: 设置排除模式为 `*.md,*.txt,*.rst` 跳过文档文件
4. **断点续传**: 如果下载中断，重新运行程序会自动继续下载
5. **设置记忆**: 程序会记住您的设置，下次使用更方便

## 📞 技术支持

如果遇到问题：
1. 查看 `advanced_download.log` 日志文件
2. 确保网络连接正常
3. 检查 Hugging Face 仓库是否可访问
4. 检查访问令牌是否有效

## 🔄 更新日志

### v1.0.0 (当前版本)
- ✅ **新增**: 智能设置管理，自动保存和加载上次配置
- ✅ **新增**: 详细进度跟踪和统计信息
- ✅ **新增**: 改进的断点续传功能
- ✅ **新增**: 文件完整性检查
- ✅ **新增**: 支持包含和排除文件模式
- ✅ **新增**: 多线程并发下载
- ✅ **新增**: 实时下载速度和ETA显示
- ✅ **改进**: 更好的错误处理和重试机制
- ✅ **改进**: Unicode编码问题修复
- ✅ **改进**: 更友好的用户界面

---

**祝您使用愉快！** 🎉 